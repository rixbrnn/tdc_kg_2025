-- Q3: For each manager, what is the total revenue generated by their team,
--     including all indirect subordinates?
--
-- Hierarchy:
--   Employee.ReportsTo -> another Employee.EmployeeId
--   Customer.SupportRepId -> Employee.EmployeeId
--
-- Goal:
--   For each "root" manager, sum all sales made by:
--     - themself
--     - all employees that (directly or indirectly) report to them.
--
-- Hints:
--   1) Build a recursive CTE over Employee:
--        WITH RECURSIVE employee_hierarchy AS (
--          SELECT EmployeeId, ReportsTo, EmployeeId AS RootEmployeeId
--          FROM Employee
--          UNION ALL
--          SELECT e.EmployeeId, e.ReportsTo, h.RootEmployeeId
--          FROM Employee e
--          JOIN employee_hierarchy h ON e.ReportsTo = h.EmployeeId
--        )
--
--   2) Join employee_hierarchy to Customer on SupportRepId
--      to get all customers in each manager's subtree.
--
--   3) Join those customers to Invoice and InvoiceLine and
--      SUM(UnitPrice * Quantity) per RootEmployeeId.
--
--   4) Join back to Employee to get the manager's name and title.
--
-- Write your SQL below:

