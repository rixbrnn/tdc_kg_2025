PREFIX : <http://example.org/chinook#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

# Q: Qual é a receita total gerada por cada artista?

SELECT ?artistName 
       (COUNT(DISTINCT ?track) AS ?totalTracks)
       (SUM(?lineTotal) AS ?totalRevenue)
WHERE {
  # Navega do artista para as faixas via álbuns
  ?artist a :Artist ;
          :name ?artistName .
  
  # Álbuns deste artista
  ?album :hasArtist ?artist .
  
  # Faixas desses álbuns
  ?track :hasAlbum ?album .
  
  # Encontra linhas de fatura que referenciam essas faixas
  ?line :lineTrack ?track ;
        :unitPrice ?price ;
        :quantity ?qty .
  
  # Calcula o total da linha
  BIND(?price * ?qty AS ?lineTotal)
}
GROUP BY ?artistName
ORDER BY DESC(?totalRevenue)
LIMIT 10
